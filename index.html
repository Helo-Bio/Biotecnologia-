<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz de Química Analítica - Missões</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f7f6;
            color: #333;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .container {
            background-color: #ffffff;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 700px;
        }
        h1, h2 {
            text-align: center;
            color: #007BFF;
        }
        #game-area {
            text-align: center;
            margin-top: 20px;
        }
        #character-img {
            max-width: 100px;
            height: auto;
            border-radius: 50%;
            margin-bottom: 15px;
            border: 3px solid #007BFF;
        }
        #mission-title {
            font-size: 1.5em;
            margin-bottom: 20px;
            color: #28a745;
        }
        #question {
            font-size: 1.2em;
            margin-bottom: 20px;
            font-weight: bold;
        }
        #image-question {
            max-width: 100%;
            height: auto;
            margin: 15px 0;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        #answers {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 20px;
        }
        .answer-btn {
            background-color: #e9ecef;
            border: 1px solid #ced4da;
            padding: 12px 20px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.1s;
            text-align: left;
            font-size: 1em;
        }
        .answer-btn:hover:not([disabled]) {
            background-color: #d1d8df;
            transform: scale(1.01);
        }
        .answer-btn:disabled {
            cursor: not-allowed;
        }
        .answer-btn.correct {
            background-color: #28a745;
            color: white;
            font-weight: bold;
            border-color: #1e7e34;
        }
        .answer-btn.wrong {
            background-color: #dc3545;
            color: white;
            font-weight: bold;
            border-color: #bd2130;
        }
        #start-btn, #next-btn {
            background-color: #007BFF;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1.1em;
            margin-top: 15px;
            transition: background-color 0.3s;
        }
        #start-btn:hover, #next-btn:hover {
            background-color: #0056b3;
        }
        .feedback-message {
            margin-top: 20px;
            padding: 15px;
            border-radius: 5px;
            text-align: left;
            font-size: 1.1em;
            font-style: italic;
        }
        .feedback-correct {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .feedback-wrong {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        #score {
            margin-top: 10px;
            font-size: 1.2em;
            font-weight: bold;
            color: #ffc107;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>Super Quiz de Química</h1>
    <h2 id="score">Pontuação: 0</h2>
    
    <div id="game-area">
        <img id="character-img" src="" alt="Personagem da missão" style="display: none;">
        <p id="mission-title"></p>
        <p id="question"></p>
        <img id="image-question" src="" alt="Imagem da pergunta" style="display: none;">
        
        <div id="answers">
            </div>

        <button id="start-btn">Começar Jogo</button>
        <button id="next-btn" style="display: none;">Próxima Pergunta >></button>
        
        <div id="feedback" class="feedback-message hidden">
            </div>
    </div>
</div>

<script>
    const missions = [
        // Missão 7: Boas Práticas e Vidrarias (Manutenção do Original)
        {
          id: 7,
          title: "Boas Práticas e Vidrarias",
          character: "img/lab_equipment.png",
          questions: [
            {
              q: "O que diferencia 'Precisão' de 'Exatidão' na Química Analítica?",
              options: [
                "Precisão é a proximidade com o valor verdadeiro, exatidão é a reprodutibilidade.",
                "Precisão é a proximidade dos resultados entre si (reprodutibilidade), exatidão é a proximidade do resultado com o valor verdadeiro.",
                "Ambos os termos significam a mesma coisa.",
                "Exatidão depende apenas do instrumento, precisão depende apenas do operador."
              ],
              correct: 1,
              explanation: "Precisão refere-se à proximidade entre si de várias medidas (reprodutibilidade), enquanto exatidão refere-se à proximidade de uma medida com o valor verdadeiro. (Teoria.pdf, pág. 25)",
              image: "img/precisao_exatidao.png"
            },
            {
              q: "Qual o objetivo da limpeza de materiais de laboratório com detergente neutro, água potável e água deionizada/desmineralizada?",
              options: [
                "Apenas para deixar o material brilhando.",
                "Eliminar possíveis contaminantes que possam causar erros no processo analítico.",
                "Economizar reagentes.",
                "Aumentar a vida útil do material."
              ],
              correct: 1,
              explanation: "A limpeza adequada é crucial para remover contaminantes que poderiam interferir nos resultados das análises, sendo o último passo com água deionizada essencial para remover resíduos minerais. (Teoria.pdf, pág. 22)",
              image: "img/limpeza_vidraria.png"
            }
          ]
        },
        // Missão 8: Reações Químicas e pH (Manutenção do Original)
        {
          id: 8,
          title: "Reações Químicas e pH",
          character: "img/gloria_reacao_quimica.png",
          questions: [
            {
              q: "Qual das seguintes observações indica que uma reação química está ocorrendo?",
              options: [
                "Liberação ou evolução de gás.",
                "Formação de precipitado.",
                "Formação de complexo ou composto de coordenação.",
                "Todas as alternativas anteriores."
              ],
              correct: 3,
              explanation: "Todas essas são evidências visíveis de que uma transformação química está acontecendo. (Teoria.pdf, pág. 49)",
              image: "img/reacao_quimica_evidencias.png"
            },
            {
              q: "O que significa a seta para baixo (↓) em uma equação química?",
              options: [
                "Liberação de gás.",
                "Formação de precipitado.",
                "Aquecimento.",
                "Reação reversível."
              ],
              correct: 1,
              explanation: "A seta para baixo indica que um produto sólido insolúvel (precipitado) foi formado. (Teoria.pdf, pág. 49)",
              image: "img/simbolo_precipitado.png"
            },
            {
              q: "Qual o resultado de uma reação de neutralização entre um ácido e uma base?",
              options: [
                "Apenas gás.",
                "Sal e água.",
                "Dois novos ácidos.",
                "Dois novos bases."
              ],
              correct: 1,
              explanation: "A reação de neutralização (ácido + base) sempre produz um sal e água. (Teoria.pdf, pág. 51)",
              image: "img/reacao_neutralizacao.png"
            },
            {
              q: "Qual o pH de uma solução neutra?",
              options: [
                "Menor que 7.",
                "Igual a 7.",
                "Maior que 7.",
                "Igual a 0."
              ],
              correct: 1,
              explanation: "A escala de pH varia de 0 a 14, sendo que valores menores que 7 indicam produtos ácidos, valores maiores que 7 indicam produtos básicos, e 7 indica neutralidade. (Teoria.pdf, pág. 51)",
              image: "img/escala_ph.png"
            },
            {
              q: "O que são 'indicadores' em reações químicas?",
              options: [
                "Substâncias que aceleram a reação.",
                "Substâncias que mudam de cor conforme o valor do pH.",
                "Substâncias que aumentam a temperatura da reação.",
                "Substâncias que formam precipitados."
              ],
              correct: 1,
              explanation: "Indicadores são substâncias que apresentam cores diferentes em diferentes faixas de pH, permitindo a visualização da variação do pH. (Teoria.pdf, pág. 51)",
              image: "img/indicadores_ph.png"
            }
          ]
        },
        // Missão 9: Análise Qualitativa de Cátions e Ânions (Manutenção do Original)
        {
          id: 9,
          title: "Análise Qualitativa de Cátions e Ânions",
          character: "img/julien_analise_qualitativa.png",
          questions: [
            {
              q: "Na análise qualitativa de cátions, como eles são geralmente separados em grupos?",
              options: [
                "Pela cor do cátion.",
                "Pelo tamanho do cátion.",
                "Conforme reagem com um reagente específico (reagente de grupo).",
                "Pela sua massa atômica."
              ],
              correct: 2,
              explanation: "Os cátions são divididos em grupos com base na sua reatividade com reagentes específicos (reagentes de grupo), que causam precipitação ou outras reações características. (Teoria.pdf, pág. 52)",
              image: "img/grupos_catios.png"
            },
            {
              q: "Qual a principal evidência visual para identificar o ânion Cloreto (Cl-) em uma solução?",
              options: [
                "Formação de gás carbônico.",
                "Formação de um precipitado branco de AgCl com nitrato de prata (AgNO3).",
                "Mudança de cor para azul.",
                "Liberação de calor."
              ],
              correct: 1,
              explanation: "A formação de um precipitado branco de cloreto de prata (AgCl) é um teste clássico para a presença de íons cloreto. (Teoria.pdf, pág. 53)",
              image: "img/teste_cloreto.png"
            },
            {
              q: "O que é o 'teste de chama' e para que é utilizado?",
              options: [
                "Para verificar a inflamabilidade de um líquido.",
                "Para identificar metais pela cor que emitem quando aquecidos diretamente em uma chama.",
                "Para medir a temperatura de uma chama.",
                "Para esterilizar materiais de laboratório."
              ],
              correct: 1,
              explanation: "O teste de chama é uma técnica qualitativa que identifica certos íons metálicos pela cor característica que eles emitem quando aquecidos em uma chama. (Teoria.pdf, pág. 55)",
              image: "img/teste_chama.png"
            },
            {
              q: "Qual a importância da formação de complexos (compostos de coordenação) na química analítica?",
              options: [
                "Eles sempre são insolúveis.",
                "Eles não têm importância prática.",
                "Eles apresentam propriedades diferentes do precipitado, sendo úteis para identificação e separação de cátions.",
                "Eles indicam a presença de ácidos fortes."
              ],
              correct: 2,
              explanation: "A formação de complexos pode alterar a solubilidade ou a cor de íons metálicos, sendo uma ferramenta valiosa para a identificação e separação em análises qualitativas. (Teoria.pdf, pág. 50)",
              image: "img/complexo_quimico.png"
            },
            {
              q: "Qual a principal característica do ânion Carbonato (CO3^2-) em presença de ácido?",
              options: [
                "Forma um precipitado azul.",
                "Libera gás oxigênio.",
                "Libera gás carbônico (CO2) com efervescência.",
                "Muda de cor para roxo."
              ],
              correct: 2,
              explanation: "Carbonatos reagem com ácidos liberando dióxido de carbono (CO2), que é observado como efervescência. (Teoria.pdf, pág. 54)",
              image: "img/reacao_carbonato_acido.png"
            }
          ]
        },
        // Missão 10: Prevenção e Combate a Incêndios (Manutenção do Original)
        {
          id: 10,
          title: "Prevenção e Combate a Incêndios",
          character: "img/alex_extintor.png",
          questions: [
            {
              q: "Quais são os três elementos básicos que compõem o 'triângulo do fogo'?",
              options: [
                "Água, ar e calor.",
                "Combustível, comburente e calor.",
                "Fumaça, chamas e faíscas.",
                "Madeira, papel e gás."
              ],
              correct: 1,
              explanation: "O fogo necessita de combustível (material que queima), comburente (geralmente oxigênio) e calor para iniciar e se manter. (Baseado em Manuais de Segurança em Laboratório)",
              image: "img/triangulo_fogo.png"
            },
            {
              q: "Qual método de extinção do fogo consiste em diminuir a temperatura do material em combustão?",
              options: [
                "Abafamento.",
                "Isolamento.",
                "Resfriamento.",
                "Extinção química."
              ],
              correct: 2,
              explanation: "O resfriamento, geralmente com água, reduz a temperatura do combustível abaixo do seu ponto de ignição, extinguindo o fogo. (Baseado em Manuais de Segurança em Laboratório)",
              image: "img/extincao_resfriamento.png"
            },
            {
              q: "O que é o 'abafamento' como método de extinção do fogo?",
              options: [
                "Remover o combustível.",
                "Interromper a reação em cadeia.",
                "Impedir que o comburente (oxigênio) permaneça em contato com o combustível.",
                "Diminuir a temperatura."
              ],
              correct: 2,
              explanation: "O abafamento remove ou reduz o oxigênio disponível para a combustão, sufocando o fogo. (Baseado em Manuais de Segurança em Laboratório)",
              image: "img/extincao_abafamento.png"
            },
            {
              q: "Qual classe de incêndio é caracterizada por materiais fibrosos ou combustíveis sólidos que deixam resíduos (cinzas ou brasas)?",
              options: [
                "Classe B.",
                "Classe C.",
                "Classe A.",
                "Classe D."
              ],
              correct: 2,
              explanation: "Incêndios de Classe A envolvem materiais como madeira, papel, borracha, tecidos, que queimam em volume e profundidade. (Baseado em Normas de Segurança)",
              image: "img/classe_a_incendio.png"
            },
            {
              q: "Qual tipo de extintor é mais adequado para incêndios de Classe A (materiais sólidos como papel e madeira)?",
              options: [
                "Extintor de CO2.",
                "Extintor de Pó Químico Seco.",
                "Extintor de Água.",
                "Extintor de Espuma."
              ],
              correct: 2,
              explanation: "O extintor de água é eficaz para incêndios de Classe A, pois age por resfriamento. (Baseado em Normas de Segurança)",
              image: "img/extintor_agua.png"
            },
            {
              q: "O que é o 'Ponto de Fulgor' de um combustível?",
              options: [
                "A temperatura em que o material entra em combustão sem fonte externa de calor.",
                "A temperatura em que o material começa a liberar vapores que se incendeiam se houver uma fonte externa de calor, mas as chamas não se mantêm.",
                "A temperatura em que o material queima completamente.",
                "A temperatura máxima que o material pode atingir."
              ],
              correct: 1,
              explanation: "Ponto de Fulgor é a temperatura mínima na qual um combustível libera vapores em quantidade suficiente para formar uma mistura inflamável com o ar, mas que não se mantém em combustão. (Baseado em Princípios de Incêndio)",
              image: "img/ponto_fulgor.png"
            },
            {
              q: "Qual a forma de propagação do fogo que ocorre quando o calor é transmitido através de uma massa de ar aquecida de um ambiente para outro?",
              options: [
                "Condução.",
                "Convecção.",
                "Irradiação.",
                "Reação em cadeia."
              ],
              correct: 1,
              explanation: "A convecção é a transmissão de calor por meio de fluidos (gases ou líquidos) aquecidos. (Baseado em Princípios de Incêndio)",
              image: "img/propagacao_conveccao.png"
            }
          ]
        },
        // **NOVA MISSÃO 11: Fundamentos da Análise Química**
        {
          id: 11,
          title: "Fundamentos da Análise Química",
          character: "img/quimica_analitica_fundamentos.png", // Imagem genérica para analítica
          questions: [
            {
              q: "Na Química Analítica, o que é um 'Erro Determinado' (ou Erro Sistemático)?",
              options: [
                "Um erro que varia aleatoriamente a cada medida.",
                "Um erro que resulta de variações não controladas (e.g., flutuações de temperatura).",
                "Um erro cuja fonte pode ser identificada e eliminada, sendo previsível em sinal e magnitude.",
                "Um erro causado exclusivamente por descuido do analista."
              ],
              correct: 2,
              explanation: "Erros determinados (sistemáticos) são aqueles cuja causa é conhecida e que podem ser corrigidos, muitas vezes relacionados ao instrumento, método ou técnica do operador. (Skoog, Fundamentos de Química Analítica)",
              image: "img/erro_analitico.png"
            },
            {
              q: "Qual a principal função da Vidraria Volumétrica, como o Balão Volumétrico, na Análise Quantitativa?",
              options: [
                "Misturar reagentes rapidamente.",
                "Aquecer soluções com segurança.",
                "Preparar soluções com volume e concentração exatos (padrões).",
                "Realizar filtrações sob vácuo."
              ],
              correct: 2,
              explanation: "O Balão Volumétrico é um material aferido e sua principal função é o preparo de soluções padrão (soluções de concentração conhecida) com alta precisão. (Vogel, Análise Química Quantitativa, pág. 40)",
              image: "img/balao_volumetrico.png"
            },
            {
              q: "O que representa o Desvio Padrão (s) em uma série de medidas?",
              options: [
                "O valor verdadeiro da concentração do analito.",
                "A diferença absoluta entre o valor máximo e o valor mínimo.",
                "A média aritmética dos resultados.",
                "A dispersão ou precisão das medidas em torno do valor médio."
              ],
              correct: 3,
              explanation: "O Desvio Padrão é uma medida estatística que indica o quanto os dados variam em relação à média. Um desvio padrão pequeno indica alta precisão (reprodutibilidade). (Skoog, Estatística Analítica)",
              image: "img/grafico_desvio_padrao.png"
            }
          ]
        },
        // **NOVA MISSÃO 12: Propriedades e Separação**
        {
          id: 12,
          title: "Propriedades e Técnicas de Separação",
          character: "img/feltre_separacao.png", // Imagem genérica para feltre
          questions: [
            {
              q: "O que é 'Efervescência' e o que ela geralmente indica em uma reação química?",
              options: [
                "Formação de precipitado sólido.",
                "Mudança de cor intensa.",
                "Liberação de calor.",
                "Liberação de gás a partir de um líquido por borbulhamento."
              ],
              correct: 3,
              explanation: "Efervescência é a liberação de gás em forma de bolhas a partir de uma solução, sendo uma das evidências de que uma reação química (como a de carbonato com ácido) está ocorrendo. (Teoria.pdf, pág. 49)",
              image: "img/efervescencia.png"
            },
            {
              q: "Qual a técnica de separação de misturas que se baseia na diferença de volatilidade dos componentes de uma mistura líquida homogênea (solução)?",
              options: [
                "Filtração.",
                "Decantação.",
                "Destilação.",
                "Centrifugação."
              ],
              correct: 2,
              explanation: "A Destilação Simples (para grandes diferenças de P.E.) ou Fracionada (para pequenas diferenças) é a técnica baseada na diferença de ponto de ebulição (volatilidade). (Feltre Vol. 2, Físico-Química)",
              image: "img/destilacao.png"
            },
            {
              q: "Na Cromatografia, o que é a Fase Móvel?",
              options: [
                "O suporte sólido que retém os componentes da mistura.",
                "O componente da mistura que se move mais lentamente.",
                "O líquido ou gás que arrasta os componentes da mistura através da Fase Estacionária.",
                "O equipamento utilizado para secar a placa."
              ],
              correct: 2,
              explanation: "A Fase Móvel é um fluido (líquido ou gás) que se move através da Fase Estacionária, arrastando consigo os componentes da amostra a diferentes velocidades para promover a separação. (Vogel Qualitativa, Cromatografia)",
              image: "img/cromatografia.png"
            }
          ]
        },
        // **NOVA MISSÃO 13: Vidraria de Precisão e Segurança Específica**
        {
          id: 13,
          title: "Vidraria Volumétrica e Riscos",
          character: "img/seguranca_avancada.png", // Imagem genérica para segurança
          questions: [
            {
              q: "Qual vidraria volumétrica é calibrada para *dispensar* volumes variáveis com alta precisão, sendo essencial em uma Titulação?",
              options: [
                "Balão volumétrico.",
                "Pipeta volumétrica.",
                "Proveta.",
                "Bureta."
              ],
              correct: 3,
              explanation: "A Bureta é calibrada para dispensar volumes variáveis com grande precisão, sendo a peça central na técnica de volumetria (titulação). (Vogel, Análise Química Quantitativa, pág. 42)",
              image: "img/bureta.png"
            },
            {
              q: "Qual o procedimento correto para ler o volume em uma vidraria graduada (e.g., proveta ou bureta)?",
              options: [
                "Ler o volume pelo ponto mais alto do menisco.",
                "Ler o volume pelo centro do menisco, com o nível dos olhos desalinhado.",
                "O operador deve alinhar o nível dos olhos com o centro do menisco (na parte inferior) para evitar o erro de paralaxe.",
                "Bater na vidraria para ter certeza de que o menisco está estável."
              ],
              correct: 2,
              explanation: "A leitura do menisco deve ser feita ao nível dos olhos e na parte inferior do menisco (para líquidos aquosos) para evitar o erro de paralaxe. (Teoria.pdf, pág. 23)",
              image: "img/leitura_menisco.png"
            },
            {
              q: "Qual é a definição de 'Analito' na Química Analítica?",
              options: [
                "O solvente utilizado na preparação da amostra.",
                "O reagente padrão cuja concentração é conhecida com precisão.",
                "O componente de interesse em uma amostra que está sendo analisado (cuja concentração ou presença se quer determinar).",
                "O nome dado à vidraria usada na pesagem."
              ],
              correct: 2,
              explanation: "Analito é o nome dado ao componente da amostra que é de interesse para o químico analítico, seja para determinar sua quantidade (quantitativa) ou sua presença (qualitativa). (Skoog, Fundamentos)",
              image: "img/analito.png"
            }
          ]
        }
      ];


      // Variáveis de estado do jogo (manutenção do original)
      let currentMissionIndex = 0;
      let currentQuestionIndex = 0;
      let score = 0;

      // Elementos do DOM
      const characterImg = document.getElementById('character-img');
      const missionTitle = document.getElementById('mission-title');
      const questionEl = document.getElementById('question');
      const imageQuestion = document.getElementById('image-question');
      const answersEl = document.getElementById('answers');
      const feedbackEl = document.getElementById('feedback');
      const startBtn = document.getElementById('start-btn');
      const nextBtn = document.getElementById('next-btn');
      const scoreEl = document.getElementById('score');

      // Adicionar imagens de placeholder para as novas missões (caso não existam as URLs)
      const placeholderImages = {
          'img/lab_equipment.png': 'https://i.imgur.com/8Qj9Y2s.png', // Vidrarias
          'img/gloria_reacao_quimica.png': 'https://i.imgur.com/7XqW4D6.png', // Reações
          'img/julien_analise_qualitativa.png': 'https://i.imgur.com/3f4Yn4q.png', // Qualitativa
          'img/alex_extintor.png': 'https://i.imgur.com/9C3Ew6R.png', // Segurança
          'img/quimica_analitica_fundamentos.png': 'https://i.imgur.com/h5r8o5m.png', // Analítica
          'img/feltre_separacao.png': 'https://i.imgur.com/JmY5V4s.png', // Separação
          'img/seguranca_avancada.png': 'https://i.imgur.com/dD9Yg1r.png', // Riscos
          // Imagens específicas de perguntas
          'img/precisao_exatidao.png': 'https://i.imgur.com/RkS2xKx.png',
          'img/limpeza_vidraria.png': 'https://i.imgur.com/Y4pT0pQ.png',
          'img/escala_ph.png': 'https://i.imgur.com/nJg7B5W.png',
          'img/grupos_catios.png': 'https://i.imgur.com/3P5y8J8.png',
          'img/triangulo_fogo.png': 'https://i.imgur.com/W2oW6H3.png',
          'img/extintor_agua.png': 'https://i.imgur.com/4B8Qz1z.png',
          'img/bureta.png': 'https://i.imgur.com/7N1sK6z.png',
          'img/leitura_menisco.png': 'https://i.imgur.com/qg4S0m7.png',
          'img/erro_analitico.png': 'https://i.imgur.com/G4Yt0Lg.png',
          'img/balao_volumetrico.png': 'https://i.imgur.com/mZ9C0bW.png',
          'img/destilacao.png': 'https://i.imgur.com/Q2y1v1J.png',
          'img/efervescencia.png': 'https://i.imgur.com/j4U1Bqg.png',
          'img/analito.png': 'https://i.imgur.com/vH9J9L6.png',
          'img/grafico_desvio_padrao.png': 'https://i.imgur.com/F3x8f0y.png',
          'img/cromatografia.png': 'https://i.imgur.com/rN5nL4c.png',
          'img/reacao_quimica_evidencias.png': 'https://i.imgur.com/aA9Lz4N.png',
          'img/simbolo_precipitado.png': 'https://i.imgur.com/m9D4o4D.png',
          'img/reacao_neutralizacao.png': 'https://i.imgur.com/F0o5YwW.png',
          'img/indicadores_ph.png': 'https://i.imgur.com/o1J1h2A.png',
          'img/teste_cloreto.png': 'https://i.imgur.com/rS2h6vM.png',
          'img/teste_chama.png': 'https://i.imgur.com/w4J7tqj.png',
          'img/complexo_quimico.png': 'https://i.imgur.com/R6Y6l0o.png',
          'img/reacao_carbonato_acido.png': 'https://i.imgur.com/Y7x9v1q.png',
          'img/extincao_resfriamento.png': 'https://i.imgur.com/3u4f8Vj.png',
          'img/extincao_abafamento.png': 'https://i.imgur.com/2oVzW4l.png',
          'img/classe_a_incendio.png': 'https://i.imgur.com/8bY2A9z.png',
          'img/ponto_fulgor.png': 'https://i.imgur.com/0zR8W2K.png',
          'img/propagacao_conveccao.png': 'https://i.imgur.com/V2v0gN0.png'
      };

      // Listener para o botão de começar
      startBtn.addEventListener('click', startGame);

      // Listener para o botão de próxima pergunta
      nextBtn.addEventListener('click', () => {
        currentQuestionIndex++;
        setNextQuestion();
      });

      // Fallback para caso as imagens não carreguem (agora com fallback para URLs públicas)
      characterImg.addEventListener('error', () => {
          const originalSrc = characterImg.getAttribute('data-original-src');
          if (placeholderImages[originalSrc] && characterImg.src !== placeholderImages[originalSrc]) {
              characterImg.src = placeholderImages[originalSrc];
              characterImg.alt = `Personagem (usando imagem de substituição)`;
          } else {
              characterImg.style.display = 'none';
          }
      });
      imageQuestion.addEventListener('error', (e) => {
          const originalSrc = e.target.getAttribute('data-original-src');
          if (placeholderImages[originalSrc] && e.target.src !== placeholderImages[originalSrc]) {
              e.target.src = placeholderImages[originalSrc];
              e.target.alt = `Imagem da pergunta (usando imagem de substituição)`;
          } else {
              e.target.style.display = 'none';
          }
      });

      function startGame() {
        score = 0;
        currentMissionIndex = 0;
        currentQuestionIndex = 0;
        startBtn.style.display = 'none';
        scoreEl.textContent = `Pontuação: ${score}`;
        setNextQuestion();
      }

      function setNextQuestion() {
        resetState();

        if (currentMissionIndex >= missions.length) {
          showScore();
          return;
        }

        const mission = missions[currentMissionIndex];

        // Se a missão não tiver perguntas, pula para a próxima
        if (!mission.questions || mission.questions.length === 0) {
          currentMissionIndex++;
          currentQuestionIndex = 0;
          setNextQuestion();
          return;
        }

        missionTitle.textContent = `Missão ${mission.id}: ${mission.title}`;

        // Definir imagem do personagem (com fallback)
        if (mission.character && mission.character.length) {
          characterImg.setAttribute('data-original-src', mission.character);
          characterImg.src = mission.character;
          characterImg.alt = `Personagem da missão ${mission.title}`;
          characterImg.style.display = 'block';
          // Se a imagem falhar, o event listener fará o fallback
        } else {
          characterImg.style.display = 'none';
        }

        // Se terminar as perguntas dessa missão, avisar e partir para a próxima
        if (currentQuestionIndex >= mission.questions.length) {
          // Pequena pausa para o jogador ler a pontuação final da missão
          setTimeout(() => {
              alert(`Missão "${mission.title}" concluída!`);
              currentMissionIndex++;
              currentQuestionIndex = 0;
              setNextQuestion();
          }, 500);
          return;
        }

        showQuestion(mission.questions[currentQuestionIndex]);
      }

      function showQuestion(questionObj) {
        questionEl.textContent = questionObj.q;

        // Imagem da pergunta (com fallback)
        if (questionObj.image) {
          imageQuestion.setAttribute('data-original-src', questionObj.image);
          imageQuestion.src = questionObj.image;
          imageQuestion.style.display = 'block';
          imageQuestion.alt = 'Imagem da pergunta';
        } else {
          imageQuestion.style.display = 'none';
          imageQuestion.src = '';
          imageQuestion.alt = '';
        }

        // criar botões de opção
        questionObj.options.forEach((option, index) => {
          const button = document.createElement('button');
          button.textContent = option;
          button.classList.add('answer-btn');
          button.addEventListener('click', () => selectAnswer(index, questionObj));
          answersEl.appendChild(button);
        });

        // ocultar o botão Próxima até que o usuário responda
        nextBtn.style.display = 'none';
      }

      function resetState() {
        nextBtn.style.display = 'none';
        feedbackEl.textContent = '';
        feedbackEl.className = 'feedback-message hidden';
        while (answersEl.firstChild) {
          answersEl.removeChild(answersEl.firstChild);
        }
      }

      function selectAnswer(selectedIndex, questionObj) {
        const buttons = answersEl.querySelectorAll('button');
        buttons.forEach((btn, idx) => {
          btn.disabled = true;
          if (idx === questionObj.correct) {
            btn.classList.add('correct');
          }
          if (idx === selectedIndex && idx !== questionObj.correct) {
            btn.classList.add('wrong');
          }
        });

        if (selectedIndex === questionObj.correct) {
          score += 10;
          feedbackEl.textContent = 'Correto! ' + questionObj.explanation;
          feedbackEl.className = 'feedback-message feedback-correct';
        } else {
          feedbackEl.textContent = 'Errado! ' + questionObj.explanation;
          feedbackEl.className = 'feedback-message feedback-wrong';
        }

        scoreEl.textContent = `Pontuação: ${score}`;

        // mostrar botão próxima
        nextBtn.style.display = 'inline-block';
      }

      function showScore() {
        resetState();
        characterImg.src = '';
        characterImg.style.display = 'none';
        missionTitle.textContent = '';
        questionEl.textContent = `PARABÉNS! Você concluiu todas as ${missions.length} missões com sucesso!`;
        startBtn.textContent = 'Jogar Novamente';
        startBtn.style.display = 'inline-block';
        feedbackEl.textContent = '';
        scoreEl.textContent = `Pontuação final: ${score}`;
      }
    </script>

</body>
</html>